{% extends "base.html" %}
{% block content %}

    <h3 class="teal-text center-align text-shadow">All Books</h3>

    <div class="row card-panel lighten-5">
        <form action="{{ url_for('search') }}" method="post" class="col s12">
            <div class="row valign-wrapper center-align">
                <div class="input-field col s12 m8">
                    <i class="fas fa-search prefix teal-text text-darken-4"></i>
                    <input type="text" name="query" id="query" minlength="1" class="validate" required>
                    <label for="query">Search</label>
                </div>
                <div class="col s12 m4">
                    <a href="{{ url_for('get_books') }}" class="red btn-small text-shadow"><i class="fas fa-backspace"></i><span class="hideing"> Reset</span></a>
                    <button type="submit" class="teal darken-1 btn-small text-shadow"><i class="fas fa-search"></i><span class="hideing"> Search</span></button>
                </div>
            </div>
        </form>
    </div>

    {% if books|length > 0 %}

    <ul class="collapsible popout">
        {% for book in books %}
        <li>
            <div class="collapsible-header white-text teal text-shadow">
                <div class="col s1 hide-on-med-and-down">
                    <i class="fas fa-caret-down"></i>
                    
                </div>
                   
                    {% if session.user | lower == book.created_by | lower %}

                        <!-- Modal Trigger -->
                        
                            <div class="col s2">
                                <a href="{{ url_for('edit_book', book_id=book._id) }}" class="btn-small waves-effect light-green accent-4">Edit</a>
                                <a class="red waves-effect waves-light btn-small modal-trigger" href="#modal1">Delete</a>
                            </div>
                        

                        <!-- Modal Structure -->
                        <div id="modal1" class="modal">
                            <div class="modal-content">
                            <h4 class="teal-text">Are you sure you want to delete this book?</h4>
                    
                            </div>
                            <div class="modal-footer">
                            <a href="{{ url_for('delete_book', book_id=book._id) }}" class="red waves-effect waves btn-small">Delete</a>
                            <a href="{{ url_for('get_books') }}" class="modal-close waves-effect waves btn-small">Cancel</a>
                            
                            </div>
                        </div>

                        
                        
                        
                    {% endif %}
                
                <div class="col s9">
                    <strong>{{ book.book_name }}</strong> | By:  {{ book.book_author }} | Release:  {{book.book_release}}  | Book Point: {{ book.book_upvote }} 
                    
                </div>
                
                

                
            </div>
            <div class="collapsible-body">
                <strong>{{ book.category_name }}</strong>
                <!--<div></div>
                <div><img src="https://images-na.ssl-images-amazon.com/images/I/41wBo8-XN7L._AC_SX368_.jpg" alt=""></div>-->
                <p>{{ book.book_description }}</p>
                <p><em>by: {{ book.created_by }}</em></p>
            </div>
        </li>
        
        {% endfor %}
        
    </ul>

    {% else %}
        <h3 class="red-text text-darken-4 center-align">No Results Found</h3>
    {% endif %}

{% endblock %}